---
title: '?'
author: '?'
date: "2021/3/27"
output: html_document
---
```{r set up, load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(knitr)
library(dplyr)
library(ggplot2)
library(tibble)
library(openintro)
library(gapminder)

```

```{r load-data, echo = FALSE}
library(readr)
ca <- read_csv(file = "ca.csv")
```

```{r Tidy data}

bars <- ca %>%
  select(DEM_GENDER, OP_NMU_EVER, BENZ_NMU_EVER, STIM_NMU_EVER, GABA_NMU_EVER, ILL_USE, BENZ_NMU_EVER) %>%
  group_by(DEM_GENDER)

# nmsl
bars$DEM_GENDER[bars$DEM_GENDER == 1] <- 1    #将男性的归类为1
bars$DEM_GENDER[bars$DEM_GENDER == 2] <- 2    #将女性的归类为2
bars$DEM_GENDER <- factor(bars$DEM_GENDER,    #转为factor形式，替换标签
                          levels=c(1, 2),
                          labels=c("Male", "Female"))

# nmsl
bars$OP_NMU_EVER[bars$OP_NMU_EVER == 0] <- 0    #将无的归类为1
bars$OP_NMU_EVER[bars$OP_NMU_EVER == 1] <- 1    #将有的归类为2
bars$OP_NMU_EVER <- factor(bars$OP_NMU_EVER,    #转为factor形式，替换标签
                           levels=c(0, 1),
                           labels=c("None", "Opioids"))


bars$BENZ_NMU_EVER[bars$BENZ_NMU_EVER == 0] <- 0    # ???
bars$BENZ_NMU_EVER[bars$BENZ_NMU_EVER == 1] <- 1    #将男性的归类为1
bars$BENZ_NMU_EVER <- factor(bars$BENZ_NMU_EVER,    #转为factor形式，替换标签
                             levels=c(0,1),
                             labels=c("No","Yes"))
glimpse(bars)
```

```{r}
ggplot(bars, aes(y = BENZ_NMU_EVER,
                 fill = DEM_GENDER)) +
  geom_bar(position = "fill") +
  labs(x = "Percentage",
       y = "Drug type: benzodiazepine",
       fill = "Gender%",
       title = "To examine if a certain gender has an inclination for drug abuse"
       )

```
