---
title: '?'
author: '?'
date: "2021/3/27"
output: html_document
---
```{r set up, load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(broom)
library(knitr)
library(dplyr)
library(ggplot2)
library(tibble)
library(openintro)
```


```{r cars}
library(openintro)
loans <- loans_full_schema %>%
  select(loan_amount, interest_rate, term, grade, 
         state, annual_income, homeownership, debt_to_income)
glimpse(loans)

ggplot(loans, aes(y = homeownership,
                  fill = grade)) +
  geom_bar(position = "fill") +
  labs(
    x = "Highest Degree",
    y = "Drug Types",
    fill = "Highest Degree",
    title = "To examine if a certain gender has an inclination for drug abuse",
    subtitle = "with some additional factors"
  )
```


```{r load-data, echo = FALSE}
# load data here, if you like
library(readr)
ca <- read_csv("ca.csv")
```

```{r Tidy data}
library(broom)
bars <- ca %>%
  select(DEM_GENDER, OP_NMU_EVER, BENZ_NMU_EVER, STIM_NMU_EVER, GABA_NMU_EVER,    ILL_USE, DAST_CAT)
  
```




```{r}
library(tidyverse)
theme_set(theme_classic())
library(maps)
library(scales)
library(readr)

region_store <- ca %>%
  filter(
    OP_NMU_EVER == 1|BENZ_NMU_EVER == 1|STIM_NMU_EVER == 1| GABA_NMU_EVER == 1|ILL_USE == 1
  ) %>%
  select(DEM_LOCATION, DAST_CAT) %>%
  group_by(DEM_LOCATION) %>%
  summarise(
    ave_dast = mean(DAST_CAT, na.rm = TRUE)
  )

names(region_store)[names(region_store) == "region"] <- "abb"

plt <- ggplot(region_store, aes(x = long, y = lat, group = group, fill = fact)) + 
  geom_polygon() +
  scale_fill_viridis_c(option = "magma") +
  theme_void() +
  labs(fill = paste(legendName, "dast_cat", sep = " "))
return(plt)
  



```

